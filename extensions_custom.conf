;--------------------------------------------------------------------------------;
; Do NOT edit this file as it is auto-generated by FreePBX. All modifications to ;
; this file must be done via the web gui. There are alternative files to make    ;
; custom modifications.                                                          ;
;--------------------------------------------------------------------------------;

;*******************************************************************************
; AUTO-GENERATED AND CUSTOM USER DIALPLAN INCLUDED HERE                        *
;*******************************************************************************

;--------------------------------------------------------------------------------;
; Customizations to this dialplan should be made in extensions_custom.conf
; See extensions_custom.conf.sample for an example.
;
; If you need to use [macro-dialout-trunk-predial-hook], [ext-did-custom], or
; [from-internal-custom] for example, place these in this file or they will get overwritten.
;
; WARNING ABOUT: #include extensions_override_freepbx.conf
;
;  This include file is put first to allow the auto-generated dialplan in FreePBX
;  to be overwritten if necessary. Overriding auto-generated dialplan should be done
;  with extreme caution. In almost all cases any custom dialplan SHOULD be put in
;  extensions_custom.conf which will not hurt a FreePBX generated dialplan. In some
;  very rare and custom situations users may have a need to override what FreePBX
;  automatically generates. If so anything in this file will do that.  If you come up
;  with situations where you need to modify the existing dialplan or macros, put it
;  here.
;
#include extensions_override_freepbx.conf
#include extensions_additional.conf
#include extensions_custom.conf
;--------------------------------------------------------------------------------;



[dialer_act_gruz]
exten => _XXXXXX!,1,Set(foo=${EXTEN})
exten => _XXXXXX!,n,Answer()
exten => _XXXXXX!,n,Set(foo=${EXTEN})
exten => _XXXXXX!,n,Set(context=${CONTEXT})
exten => _XXXXXX!,n,Noop(${ORDER})
exten => _XXXXXX!,n,Set(tag="brosil")
exten => _XXXXXX!,n,Set(name=${UNIQUEID}${CONTEXT})
exten => _XXXXXX!,n,Wait(1)
exten => _XXXXXX!,n,Monitor(wav,/tmp/${name},o)
exten => _XXXXXX!,n,Playback(/opt/yandex_speech/audio/dialer_act_gruz)
exten => _XXXXXX!,n,WaitForSilence(1610,1,15)
exten => _XXXXXX!,n,StopMonitor()
exten => _XXXXXX!,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => _XXXXXX!,n,Noop(${RESULT})
exten => _XXXXXX!,n,GotoIf($["${RESULT}" = "yes_q"]?yes,s,1)
exten => _XXXXXX!,n,GotoIf($["${RESULT}" = "no_q"]?no,s,1)
exten => _XXXXXX!,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},${EXTEN},1)
exten => _XXXXXX!,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)


[dialer_act_avto]
exten => _XXXXXX!,1,Set(foo=${EXTEN})
exten => _XXXXXX!,n,Answer()
exten => _XXXXXX!,n,Set(foo=${EXTEN})
exten => _XXXXXX!,n,Set(context=${CONTEXT})
exten => _XXXXXX!,n,Noop(${ORDER})
exten => _XXXXXX!,n,Set(tag="brosil")
exten => _XXXXXX!,n,Set(name=${UNIQUEID}${CONTEXT})
exten => _XXXXXX!,n,Wait(1)
exten => _XXXXXX!,n,Monitor(wav,/tmp/${name},o)
exten => _XXXXXX!,n,Playback(/opt/yandex_speech/audio/dialer_act_avto)
exten => _XXXXXX!,n,WaitForSilence(1610,1,15)
exten => _XXXXXX!,n,StopMonitor()
exten => _XXXXXX!,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => _XXXXXX!,n,Noop(${RESULT})
exten => _XXXXXX!,n,GotoIf($["${RESULT}" = "yes_q"]?yes,s,1)
exten => _XXXXXX!,n,GotoIf($["${RESULT}" = "no_q"]?no,s,1)
exten => _XXXXXX!,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},${EXTEN},1)
exten => _XXXXXX!,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[dialer]
exten => _XXXXXX!,1,Set(foo=${EXTEN})
exten => _XXXXXX!,n,Answer()
exten => _XXXXXX!,n,Set(foo=${EXTEN})
exten => _XXXXXX!,n,Set(context=${CONTEXT})
exten => _XXXXXX!,n,Noop(${ORDER})
exten => _XXXXXX!,n,Set(tag="brosil")
exten => _XXXXXX!,n,Set(name=${UNIQUEID}${CONTEXT})
exten => _XXXXXX!,n,Wait(1)
exten => _XXXXXX!,n,Monitor(wav,/tmp/${name},o)
exten => _XXXXXX!,n,Playback(/tmp/${EXTEN})
exten => _XXXXXX!,n,WaitForSilence(1520,1,15)
exten => _XXXXXX!,n,StopMonitor()
exten => _XXXXXX!,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => _XXXXXX!,n,Noop(${RESULT})
exten => _XXXXXX!,n,GotoIf($["${RESULT}" = "yes_q"]?yes,s,1)
exten => _XXXXXX!,n,GotoIf($["${RESULT}" = "no_q"]?no,s,1)
exten => _XXXXXX!,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},${EXTEN},1)
exten => _XXXXXX!,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[cheap]
exten => s,1,Set(tag="cheap")
exten => s,n,Playback(/opt/yandex_speech/audio/cheap)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[fixcar]
exten => s,1,Set(tag="fixcar")
exten => s,n,Playback(/opt/yandex_speech/audio/fixcar)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[malo]
exten => s,1,Set(tag="malo")
exten => s,n,Playback(/opt/yandex_speech/audio/malo)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[nextweek]
exten => s,1,Set(tag="nextweek")
exten => s,n,Playback(/opt/yandex_speech/audio/nextweek)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[podrabotka]
exten => s,1,Set(tag="late")
exten => s,n,Playback(/opt/yandex_speech/audio/podrabotka)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[poka_net]
exten => s,1,Set(tag="poka_net")
exten => s,n,Playback(/opt/yandex_speech/audio/poka_net)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[pozhe]
exten => s,1,Set(tag="pozhe")
exten => s,n,Playback(/opt/yandex_speech/audio/pozhe)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[sick]
exten => s,1,Set(tag="sick")
exten => s,n,Playback(/opt/yandex_speech/audio/pozhe)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)


[no]
exten => s,1,Set(tag="no")
exten => s,n,Playback(/opt/yandex_speech/audio/bad)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[autocall]
exten => s,1,Set(tag="auto")
;exten => s,n,Playback(/opt/yandex_speech/audio/bad)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[office]
exten => s,1,Set(tag="office")
exten => s,n,Playback(/opt/yandex_speech/audio/office)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)


[talk]
exten => s,1,Set(tag="talk")
exten => s,n,Playback(/opt/yandex_speech/audio/talk)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)


[undefined]

exten => s,1,Playback(/opt/yandex_speech/audio/undefined)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)


[no_q]
exten => s,1,Noop(${tag})
exten => s,n,Set(status=${tag})
exten => s,n,GotoIf($[${status} = "yes"]?hang:yes,s,1)
exten => s,n(hang),Playback(/opt/yandex_speech/audio/bad)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[yes_q]
exten => s,1,Set(name=${UNIQUEID})
exten => s,n,Set(status=${tag})
exten => s,n,Monitor(wav,/tmp/${name},o)
;exten => s,n,Playback(/opt/yandex_speech/audio/noyes)
exten => s,n,WaitForSilence(1520,1,15)
exten => s,n,StopMonitor()
exten => s,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => s,n,Noop(${RESULT})
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} != "yes"]?yes,s,1)
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} = "yes"]?quest,s,1)
exten => s,n,GotoIf($["${RESULT}" = "allo"]?allo,s,1)
exten => s,n,GotoIf($["${RESULT}" = ""]?void,s,1)
;exten => s,n,GotoIf($["${RESULT}" = "no"]?no_q,s,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(rm -f /tmp/${foo}.wav)

[allo]
exten => s,1,Set(name=${UNIQUEID})
exten => s,n,Set(status=${tag})
exten => s,n,Monitor(wav,/tmp/${name},o)
exten => s,n,Playback(/opt/yandex_speech/audio/allo)
exten => s,n,WaitForSilence(1650,1,15)
exten => s,n,StopMonitor()
exten => s,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => s,n,Noop(${RESULT})
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} != "yes"]?yes,s,1)
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} = "yes"]?quest,s,1)
exten => s,n,GotoIf($["${RESULT}" = ""]?void,s,1)
exten => s,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},s,1)
;exten => s,n,GotoIf($["${RESULT}" = "no"]?no_q,s,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(rm -f /tmp/${foo}.wav)


[quest]
exten => s,1,Set(name=${UNIQUEID})
exten => s,n,Playback(/opt/yandex_speech/audio/well)
exten => s,n,Monitor(wav,/tmp/${name},o)
exten => s,n,WaitForSilence(1690,1,15)
exten => s,n,StopMonitor()
exten => s,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => s,n,Noop(${RESULT})
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} != "yes"]?yes,s,1)
exten => s,n,GotoIf($["${RESULT}" = "no"]?no_q,s,1)
exten => s,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},s,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(rm -f /tmp/${foo}.wav)

[yes]
exten => s,1,Set(tag="yes")
exten => s,n,Set(name=${UNIQUEID})
exten => s,n,Monitor(wav,/tmp/${name},o)
exten => s,n,Playback(/opt/yandex_speech/audio/${context}-yes)
exten => s,n,GotoIf($["${context}" = "dialer_act_gruz"]?hang)
exten => s,n,GotoIf($["${context}" = "dialer_act_avto"]?hang)
exten => s,n,WaitForSilence(1500,1,15)
exten => s,n,StopMonitor()
exten => s,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => s,n,Noop(${RESULT})
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} = "yes"]?yes_q,s,1)
;exten => s,n,GotoIf($["${RESULT}" = "no"]?no_q,s,1)
exten => s,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},s,1)
exten => s,n,GotoIf($["${RESULT}" = ""]?void,s,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => s,n(hang),Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[late]
exten => s,1,Set(tag="late")
exten => s,n,Playback(/opt/yandex_speech/audio/bad)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[tomorrow]
exten => s,1,Set(tag="tomorrow")
exten => s,n,Playback(/opt/yandex_speech/audio/tomorrow)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[hour]
exten => s,1,Set(tag="hour")
exten => s,n,Playback(/opt/yandex_speech/audio/hour)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)


[work]
exten => s,1,Set(name=${UNIQUEID})
exten => s,n,Monitor(wav,/tmp/${name},o)
exten => s,n,Playback(/opt/yandex_speech/audio/work)
exten => s,n,WaitForSilence(1570,1,15)
exten => s,n,StopMonitor()
exten => s,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => s,n,Noop(${RESULT})
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} != "yes"]?yes,s,1)
exten => s,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},s,1)
exten => s,n,GotoIf($["${RESULT}" = ""]?void,s,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[answer]
exten => s,1,Set(name=${UNIQUEID})
exten => s,n,Playback(/opt/yandex_speech/audio/${RESULT})
exten => s,n,Monitor(wav,/tmp/${name},o)
exten => s,n,Playback(/opt/yandex_speech/audio/quest)
exten => s,n,WaitForSilence(1570,1,15)
exten => s,n,StopMonitor()
exten => s,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => s,n,Noop(${RESULT})
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} != "yes"]?yes,s,1)
;exten => s,n,GotoIf($["${RESULT}" = "no"]?no_q,s,1)
exten => s,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},s,1)
exten => s,n,GotoIf($["${RESULT}" = ""]?void,s,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)


[company]
exten => s,1,Set(name=${UNIQUEID})
exten => s,n,Playback(/opt/yandex_speech/audio/company)
exten => s,n,Monitor(wav,/tmp/${name},o)
exten => s,n,WaitForSilence(1570,1,15)
exten => s,n,StopMonitor()
exten => s,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => s,n,Noop(${RESULT})
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} != "yes"]?yes,s,1)
exten => s,n,GotoIf($["${RESULT}" = "yes_q" & ${tag} != "yes"]?yes,s,1)
exten => s,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},s,1)
exten => s,n,GotoIf($["${RESULT}" = "no_q"]?no,s,1)
exten => s,n,GotoIf($["${RESULT}" = ""]?void,s,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[yandex]
exten => s,1,Set(name=${UNIQUEID})
exten => s,n,Playback(/opt/yandex_speech/audio/yandex)
exten => s,n,Monitor(wav,/tmp/${name},o)
exten => s,n,WaitForSilence(1570,1,15)
exten => s,n,StopMonitor()
exten => s,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => s,n,Noop(${RESULT})
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} != "yes"]?yes,s,1)
exten => s,n,GotoIf($["${RESULT}" = "yes_q" & ${tag} != "yes"]?yes,s,1)
exten => s,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},s,1)
exten => s,n,GotoIf($["${RESULT}" = ""]?void,s,1)
;exten => s,n,GotoIf($["${RESULT}" = "no"]?no_q,s,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,Wait(10)
exten => h,3,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[void]
exten => s,1,Noop(${ORDER})
exten => s,n,Set(name=${UNIQUEID})
exten => s,n,Monitor(wav,/tmp/${name},o)
exten => s,n,Playback(/opt/yandex_speech/audio/void)
exten => s,n,WaitForSilence(1500,1,15)
exten => s,n,StopMonitor()
;exten => s,n,Set(RESULT=${yes})
exten => s,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => s,n,Noop(${RESULT})
exten => s,n,GotoIf($["${RESULT}" = "void"]?undefined,s,1)
exten => s,n,GotoIf($["${RESULT}" = ""]?undefined,s,1)
exten => s,n,GotoIf($["${RESULT}" = "allo"]?${CONTEXT},s,1)
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} != "yes"]?yes,s,1)
;exten => s,n,GotoIf($["${RESULT}" = "no"]?no_q,s,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)

[none]
exten => s,1,Noop(${ORDER})
exten => s,n,Set(name=${UNIQUEID})
exten => s,n,Set(status="none")
exten => s,n,Monitor(wav,/tmp/${name},o)
exten => s,n,Playback(/opt/yandex_speech/audio/none)
exten => s,n,WaitForSilence(1550,1,15)
exten => s,n,StopMonitor()
exten => s,n,Set(RESULT=${yes})
exten => s,n,Set(RESULT=${SHELL(/usr/bin/python3 /opt/yandex_speech/stt2.py /tmp/${name}-in.wav ${foo})})
exten => s,n,Noop(${RESULT})
exten => s,n,GotoIf($["${RESULT}" = "none"]?undefined,s,1)
exten => s,n,GotoIf($["${RESULT}" = ""]?void,s,1)
exten => s,n,GotoIf($["${RESULT}" = "allo"]?allo,s,1)
exten => s,n,GotoIf($["${RESULT}" = "yes" & ${tag} != "yes"]?yes,s,1)
;exten => s,n,GotoIf($["${RESULT}" = "no"]?no_q,s,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(${RESULT})} = 1]?${RESULT},s,1:answer,s,1)
exten => s,n,Hangup()
exten => h,1,System(curl -X POST "https://yandexform.ru/amo/recognize/recognize.php" \-F number=${foo} \-F tag=${tag} \-F context=${context})
exten => h,2,System(sudo /usr/bin/python3 /opt/yandex_speech/remove.py /tmp/${foo}.wav)


[test]
exten => s,1,Background(/var/lib/asterisk/sounds/ru/custom/alivars1)
exten => 1,1,Dial(SIP/megafon/88002229003,30,t&m)

[alisa_avto_first]
exten => _XXXXXX!,1,Set(foo=${EXTEN})
exten => _XXXXXX!,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="vzal")
exten => _XXXXXX!,n,WaitExten(1)
exten => _XXXXXX!,n,Background(/var/lib/asterisk/sounds/ru/custom/alihello)
exten => _XXXXXX!,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="plus")
exten => _XXXXXX!,n,Goto(vars1,s,1)

[vars1]
exten => s,1,Background(/var/lib/asterisk/sounds/ru/custom/alivars1)
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="minus")
exten => s,n,WaitExten(12)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(var0,s,1)
exten => 2,1,Goto(var1,s,1)
exten => 3,1,Goto(var3,s,1)
exten => 4,1,Goto(var2,s,1)
exten => 5,1,Goto(var4,s,1)
exten => s,n,Hangup()

[var0]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar0)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 2,1,Goto(var01,s,1)
exten => 3,1,Goto(var02,s,1)
exten => 1,1,Goto(vars1,s,1)
exten => s,n,Hangup()


[var01]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar01)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(vars1,s,1)
exten => s,n,Hangup()

[var02]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar02)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(vars1,s,1)
exten => s,n,Hangup()

[var1]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar0)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(var01,s,1)
exten => 2,1,Goto(var02,s,1)
exten => s,n,Hangup()

[var2]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar2)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(vars1,s,1)
exten => s,n,Hangup()

[var3]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar3)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(vars1,s,1)
exten => s,n,Hangup()

[var4]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar5)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(vars1,s,1)
exten => s,n,Hangup()

[alisa_avto_line]
exten => _XXXXXX!,1,Set(foo=${EXTEN})
exten => _XXXXXX!,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="vzal")
exten => _XXXXXX!,n,WaitExten(1)
exten => _XXXXXX!,n,Background(/var/lib/asterisk/sounds/ru/custom/alihello2)
exten => _XXXXXX!,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="ravno")
exten => _XXXXXX!,n,Goto(avars1,s,1)

[avars1]
exten => s,1,Background(/var/lib/asterisk/sounds/ru/custom/alivars2)
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="del")
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(avar1,s,1)
exten => 2,1,Goto(avar2,s,1)
exten => 3,1,Goto(avar3,s,1)
exten => 4,1,Goto(avar4,s,1)
exten => s,n,Hangup()

[avar1]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar11)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(avars1,s,1)
exten => s,n,Hangup()

[avar2]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar21)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(avars1,s,1)
exten => s,n,Hangup()

[avar3]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar0113)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(avars1,s,1)
exten => s,n,Hangup()

[avar4]
exten => s,1,System(curl -X POST "https://yandexform.ru/amo/task.php" \-F number=${foo})
exten => s,n,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar41)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(avars1,s,1)
exten => s,n,Hangup()

[alisa_avto_act]
exten => _XXXXXX!,1,Set(foo=${EXTEN})
exten => _XXXXXX!,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="vzal")
exten => _XXXXXX!,n,WaitExten(1)
exten => _XXXXXX!,n,Background(/var/lib/asterisk/sounds/ru/custom/alihello3)
exten => _XXXXXX!,n,Goto(aavars1,s,1)

[aavars1]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivars3)
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="neb")
exten => s,n,WaitExten(12)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(aavar1,s,1)
exten => 2,1,Goto(aavar2,s,1)
exten => 3,1,Goto(aavar3,s,1)
exten => s,n,Hangup()

[aavar1]
exten => s,1,System(curl -X POST "https://yandexform.ru/amo/taskcall.php" \-F number=${foo} \-F tag="now")
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="actnow")
exten => s,n,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aalivar1)
exten => s,n,Hangup()

[aavar2]
exten => s,1,System(curl -X POST "https://yandexform.ru/amo/taskcall.php" \-F number=${foo} \-F tag="late")
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="actlate")
exten => s,n,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aalivar2)
exten => s,n,Hangup()

[aavar3]
exten => s,1,System(curl -X POST "https://yandexform.ru/amo/taskcall.php" \-F number=${foo} \-F tag="no")
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="noact")
exten => s,n,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aalivar3)
exten => s,n,Hangup()

[alisa_avto_first_b]
exten => _XXXXXX!,1,Set(foo=${EXTEN})
exten => _XXXXXX!,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="vzal")
exten => _XXXXXX!,n,WaitExten(1)
exten => _XXXXXX!,n,Background(/var/lib/asterisk/sounds/ru/custom/balihello)
exten => _XXXXXX!,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="plus")
exten => _XXXXXX!,n,Goto(bvars1,s,1)

[bvars1]
exten => s,1,Background(/var/lib/asterisk/sounds/ru/custom/balivars1)
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="minus")
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bvar0,s,1)
exten => 2,1,Goto(bvar1,s,1)
exten => 3,1,Goto(bvar2,s,1)
exten => 4,1,Goto(bvar4,s,1)
exten => 5,1,Goto(bvar3,s,1)
exten => s,n,Hangup()

[bvar0]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar0)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 2,1,Goto(bvar01,s,1)
exten => 3,1,Goto(bvar02,s,1)
exten => 1,1,Goto(bvars1,s,1)
exten => s,n,Hangup()


[bvar01]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar01)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bvars1,s,1)
exten => s,n,Hangup()

[bvar02]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar02)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bvars1,s,1)
exten => s,n,Hangup()

[bvar1]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar0)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bvar01,s,1)
exten => 2,1,Goto(bvar02,s,1)
exten => s,n,Hangup()

[bvar2]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/balivar2)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bvars1,s,1)
exten => s,n,Hangup()

[bvar3]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar5)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bvars1,s,1)
exten => s,n,Hangup()

[bvar4]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/balivar4)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bvars1,s,1)
exten => s,n,Hangup()

[alisa_avto_line_b]
exten => _XXXXXX!,1,Set(foo=${EXTEN})
exten => _XXXXXX!,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="vzal")
exten => _XXXXXX!,n,WaitExten(1)
exten => _XXXXXX!,n,Background(/var/lib/asterisk/sounds/ru/custom/balihello2)
exten => _XXXXXX!,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="ravno")
exten => _XXXXXX!,n,Goto(bavars1,s,1)

[bavars1]
exten => s,1,Background(/var/lib/asterisk/sounds/ru/custom/balivars2)
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="del")
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bavar1,s,1)
exten => 2,1,Goto(bavar2,s,1)
//exten => 3,1,Goto(bavar3,s,1)
exten => 3,1,Goto(bavar4,s,1)
exten => s,n,Hangup()

[bavar1]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar11)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bavars1,s,1)
exten => s,n,Hangup()

[bavar2]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/balivar21)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bavars1,s,1)
exten => s,n,Hangup()

[bavar3]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar0113)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bavars1,s,1)
exten => s,n,Hangup()

[bavar4]
exten => s,1,System(curl -X POST "https://yandexform.ru/amo/task.php" \-F number=${foo})
exten => s,n,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivar41)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aliback)
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(bavars1,s,1)
exten => s,n,Hangup()

[alisa_avto_act_b]
exten => _XXXXXX!,1,Set(foo=${EXTEN})
exten => _XXXXXX!,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="vzal")
exten => _XXXXXX!,n,WaitExten(1)
exten => _XXXXXX!,n,Background(/var/lib/asterisk/sounds/ru/custom/balihello3)
exten => _XXXXXX!,n,Goto(baavars1,s,1)

[baavars1]
exten => s,1,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/alivars3)
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="neb")
exten => s,n,WaitExten(10)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aligg)
exten => 1,1,Goto(baavar1,s,1)
exten => 2,1,Goto(baavar2,s,1)
exten => 3,1,Goto(baavar3,s,1)
exten => s,n,Hangup()

[baavar1]
exten => s,1,System(curl -X POST "https://yandexform.ru/amo/taskcall.php" \-F number=${foo} \-F tag="now")
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="actnow")
exten => s,n,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aalivar1)
exten => s,n,Hangup()

[baavar2]
exten => s,1,System(curl -X POST "https://yandexform.ru/amo/taskcall.php" \-F number=${foo} \-F tag="late")
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="actlate")
exten => s,n,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aalivar2)
exten => s,n,Hangup()

[baavar3]
exten => s,1,System(curl -X POST "https://yandexform.ru/amo/taskcall.php" \-F number=${foo} \-F tag="no")
exten => s,n,System(curl -X POST "https://yandexform.ru/amo/callback.php" \-F number=${foo} \-F tag="noact")
exten => s,n,WaitExten(1)
exten => s,n,Background(/var/lib/asterisk/sounds/ru/custom/aalivar3)
exten => s,n,Hangup()


;*******************************************************************************
; DIALPLAN OPEN TO THE PUBLIC, USING INBOUND DIDS AND SIMILAR                  *
;*******************************************************************************
;

;-------------------------------------------------------------------------------
; from-digital:
;
; Context to set for PRI's and equivalent
;

;-------------------------------------------------------------------------------



;*******************************************************************************
; INTERNAL DIALPLAN, NOT OPEN TO THE PUBLIC WORLD                              *
;*******************************************************************************
;

;-------------------------------------------------------------------------------
; from-internal:
;
; Internal dialplan that most internal phones have access to
;
[from-internal]
include => from-internal-noxfer
include => from-internal-xfer
include => bad-number ; auto-generated
exten => h,1,Macro(hangupcall)
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; from-internal-noxfer:
;
; Place to put internal dialplan that should not be accessible during a blind
; transfer, this context will not be visible during such.
;
[from-internal-noxfer]
include => from-internal-noxfer-custom
include => from-internal-noxfer-additional ; auto-generated
exten => h,1,Macro(hangupcall)
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; from-internal-xfer:
;
; Place to put most internal dialplan, will be visible during normal calls and
; blind transfers.
;
[from-internal-xfer]
include => from-internal-custom
include => from-internal-additional ; auto-generated
exten => h,1,Macro(hangupcall)
;-------------------------------------------------------------------------------



;*******************************************************************************
; INTERNAL MACROS & SPECIAL CONTEXTS                                           *
;*******************************************************************************
;

;-------------------------------------------------------------------------------
; from-did-direct:
;
; forces ext-findmefollow to take precedence over ext-local. Also exposed to
; the public side to allow an extension number to be used as an external DID
; without requiring inbound routes to be created, common in many PRI installations
; where the last 4 digits are used as the extnension and DIDs are delivered in
; 4 digit formats.
;
[from-did-direct]
include => ext-findmefollow
include => ext-local
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-dial has been converted into a function.
; see core/functions.inc/macro-dial.php
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-get-vmcontext:
;
; returns the user's voicemail context
;
[macro-get-vmcontext]
exten => s,1,Set(VMCONTEXT=${DB(AMPUSER/${ARG1}/voicemail)})
exten => s,2,GotoIf($["foo${VMCONTEXT}" = "foo"]?200:300)
exten => s,200,Set(VMCONTEXT=default)
exten => s,300,NoOp()
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-outisbusy:
;
; Moved to extensions_additional
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-dialout-trunk-predial-hook:
;
; this macro intentionally left blank so it may be safely overwritten for any custom
; requirements that an installation may have.
;
; the macro is called by macro-dialout-trunk just prior to making a Dial() attempt
; to a trunk.
;
; MACRO RETURN CODE: ${PREDIAL_HOOK_RET}
;                    if set to "BYPASS" then this trunk will be skipped
;
;
[macro-dialout-trunk-predial-hook]
exten => s,1,MacroExit()
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-dialout-one-predial-hook
;
; this macro intentionally left blank so it may be safely overwritten for any custom
; requirements that an installation may have.
;
; the macro is called by macro-dialout-trunk just prior to making a Dial() attempt
; to an individual extension.
;
[macro-dialout-one-predial-hook]
exten => s,1,MacroExit()
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-dial-hunt-predial-hook
;
; this macro intentionally left blank so it may be safely overwritten for any custom
; requirements that an installation may have.
;
; the macro is called by macro-dial just prior to making a Dial() attempt
; to an individual extension.
;
[macro-dial-hunt-predial-hook]
exten => s,1,MacroExit()
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-dial-ringall-predial-hook
;
; this macro intentionally left blank so it may be safely overwritten for any custom
; requirements that an installation may have.
;
; the macro is called by macro-dial just prior to making a Dial() attempt
; to a dial string full of extensions.
;
[macro-dial-ringall-predial-hook]
exten => s,1,MacroExit()
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-dialout-dundi-predial-hook:
;
; this macro intentionally left blank so it may be safely overwritten for any custom
; requirements that an installation may have.
;
; the macro is called by macro-dialout-dundi just prior to making a Dial() attempt
; to a trunk.
;
; MACRO RETURN CODE: ${PREDIAL_HOOK_RET}
;                    if set to "BYPASS" then this trunk will be skipped
;
;
[macro-dialout-dundi-predial-hook]
exten => s,1,MacroExit()
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; default
;
; FreePBX does not use the default context. This context is used by asterisk when
; it has no other information provided and needs to deliver a call. Hitting this means
; there has been some sort of configuration error, or a potential bug somehwere.
; This context can be reached from either internal or external sources.
;
[default]
exten => _.,1,Playback(vm-goodbye)
exten => _.,n,Noop(ERROR: FreePBX Does not use the [default] context, confguration error)
exten => _.,n,Macro(hangupcall)
;-------------------------------------------------------------------------------



;*******************************************************************************
; DEPRECATED DIALPLAN - THESE WILL BE REMOVED, NOT USED BY FREEPBX             *
;*******************************************************************************
;

;-------------------------------------------------------------------------------
; macro-fixcid: [DEPRECATED]
;
; For some reason, if I don't run setCIDname, CALLERID(name) will be blank in my AGI
;
[macro-fixcid]
exten => s,1,Set(CALLERID(name)=${CALLERID(name)})
;-------------------------------------------------------------------------------


;-------------------------------------------------------------------------------
; macro-sayXXXX: [DEPRECATED]
;
; Text-To-Speech related macros
; These all follow common actions.  First try to playback a file "tts/custom-md5"
; where "md5" is the md5() of whatever is going to be played. If that doesn't exist,
; try to playback using macro-tts-sayXXXXX (where XXXXX is text/digits/etc, same as
; the macro below). If that macro exits with MACRO_OFFSET=100, then it's done,
; otherwise, fallback to the default asterisk method.
;

;-------------------------------------------------------------------------------
; macro-saytext: [DEPRECATED]
;
; say text is purely for text-to-speech, there is no fallback
;
[macro-saytext]
exten => s,1,Noop(Trying custom SayText playback for "${ARG1}")
exten => s,n,Playback(tts/custom-${MD5(${ARG1})})
exten => s,n,GotoIf($["${PLAYBACKSTATUS}"="SUCCESS"]?done)
; call tts-saytext. This should set MACRO_OFFSET=101 if it was successful
exten => s,n(tts),Macro(tts-saytext,${ARG1},${ARG2},${ARG3})
exten => s,n,Noop(No text-to-speech handler for SayText, cannot say "${ARG1}")
exten => s,n,Goto(done)
exten => s,tts+101,Noop(tts handled saytext)
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-sayname: [DEPRECATED]
;
; say name is for saying names typically, but fallsback to using SayAlpha
; (saying the word letter-by-letter)
;
[macro-sayname]
exten => s,1,Noop(Trying custom SayName playback for "${ARG1}")
exten => s,n,Playback(tts/custom-${MD5(${ARG1})})
exten => s,n,GotoIf($["${PLAYBACKSTATUS}"="SUCCESS"]?done)
; call tts-sayalpha. This should set MACRO_OFFSET=101 if it was successful
exten => s,n(tts),Macro(tts-sayalpha,${ARG1},${ARG2},${ARG3})
exten => s,n,SayAlpha(${ARG1})
exten => s,n,Goto(done)
exten => s,tts+101,Noop(tts handled sayname)
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-saynumber: [DEPRECATED]
;
; Say number is for saying numbers (eg "one thousand forty six")
;
[macro-saynumber]
exten => s,1,Noop(Trying custom SayNumber playback for "${ARG1}")
exten => s,n,Playback(tts/custom-${MD5(${ARG1})})
exten => s,n,GotoIf($["${PLAYBACKSTATUS}"="SUCCESS"]?done)
; call tts-saynumber. This should set MACRO_OFFSET=101 if it was successful
exten => s,n(tts),Macro(tts-saynumber,${ARG1},${ARG2},${ARG3})
exten => s,n,SayNumber(${ARG1})
exten => s,n,Goto(done)
exten => s,tts+101,Noop(tts handled saynumber)
;-------------------------------------------------------------------------------

;-------------------------------------------------------------------------------
; macro-saydigits: [DEPRECATED]
;
; Say digits is for saying digits one-by-one (eg, "one zero four six")
;
[macro-saydigits]
exten => s,1,Noop(Trying custom SayDigits playback for "${ARG1}")
exten => s,n,Playback(tts/custom-${MD5(${ARG1})})
exten => s,n,GotoIf($["${PLAYBACKSTATUS}"="SUCCESS"]?done)
; call tts-saydigits. This should set MACRO_OFFSET=101 if it was successful
exten => s,n(tts),Macro(tts-saydigits,${ARG1},${ARG2},${ARG3})
exten => s,n,SayDigits(${ARG1})
exten => s,n,Goto(done)
;-------------------------------------------------------------------------------
